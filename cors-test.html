<!doctype html>

<html lang="en">
    <head>
        <meta charset="utf-8">
    
        <title>CORS Test</title>
        <style>
            #response-container {
                width: 800px;
                height: 400px;
            }
            #status-code {
                font-weight: bold;
            }
            dl {
                  display: grid;
                  grid-template-columns: max-content auto;
                  row-gap: 10px;
            }

            dt {
                  grid-column-start: 1;
            }

            dd {
                  grid-column-start: 2;
            }
        </style>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script>
            window.onload = function() {
              init();
            };

            function init() {
                data = '';
                $('#cors-form').submit(function(e) {
                    url = $('#endpoint').val();
                    $.ajax({
                      type: $('#method').val(),
                      beforeSend: function(request) {
                        request.setRequestHeader("Authorization", 'Bearer '+ $('#bearer_token').val());
                      },
                      url: url,
                      data: data,
                      success: function(data, statusCode, xhr) {
                        success(data, statusCode, xhr);
                      },
                      dataType: 'json'
                    });
                    e.preventDefault();
                });
            }

            function success(data, statusCode, xhr) {
                        console.log('logging: '+ xhr.status);
                console.log('success');
                console.log('code: '+ xhr.status);
                console.log('here now');
                var dataStr = JSON.stringify(data, undefined, 4);
                $('#status-code').html(xhr.status);
                $('#response-container').text(dataStr);
            }
        </script>
    </head>

    <body>
        <form id="cors-form">
            <dl>
                <dt>Bearer token:</dt>
                <dd><input type="text" id="bearer_token" style="width:500px" /></dd>
                
                <dt>Method:</dt>
                <dd><select id="method">
                        <option>GET</option>
                        <option>POST</option>
                        <option>PATCH</option>
                        <option>DELETE</option>
                    </select>
                </dd>

                <dt>Endpoint:</dt>
                <dd><input type="text" id="endpoint" value="https://reqres.in/api/users?page=2" style="width:500px" /></dd>
            </dl>
            
            <p>
                <input type="submit" name="submit" value="submit" />
            </p>
        </form>

        <h3>Response</h3>
        <p>Status code: <span id="status-code"></span></p>
        <p>Data: </p>
        <textarea id="response-container">
        </textarea>
    </body>
</html>
